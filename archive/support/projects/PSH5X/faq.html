
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<!-- If no var is set for $page_title on the top of each page than default title will be HDF Group -->

<title>
HDF PSH5X Project</title>
	<meta name="keywords" content="hdf, hdfeos, blog, hdf blog, hdf5 blog, hdf5, hdf4, hdf tools, hdf libraries, hdf viewer, hdf format, hdf file, hdf java, nafxcw.lib, phdf5, open source, hierarchical data format, ncsa, database, python hdf, mike folk, hdfview, hdf5 parallel" />
	<meta name="description" content="The HDF Group is a not-for-profit corporation with the mission of sustaining the HDF technologies and supporting HDF user communities worldwide with production-quality software and services." />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="expires" content="Wed, 26 Feb 2010 08:21:57 GMT" />
	<meta name="verify-v1" content="/m03HNmaDgGAcDe0PFtEVnXGtCkoeOocjr/Jwey2gdI=" />
	<link href="../../css/layout.css" rel="stylesheet" type="text/css" media="screen, projection" />
	<link href="../../css/print.css" rel="stylesheet" type="text/css" media="print" />
	<link rel="stylesheet" type="text/css" href="../../css/js_style.css" />
	<link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon" />
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/prototype/1.7.2.0/prototype.js"></script>
	<!--<script type="text/javascript" src="/scriptaculous/lib/prototype.js"></script>-->
	<script type="text/javascript" src="../../scriptaculous/src/effects.js"></script>
	<script type="text/javascript" src="../../scriptaculous/validation.js"></script>
	<script type="text/javascript" src="../../scriptaculous/animatedcollapse.js"></script>
	<script type="text/javascript" src="../../scriptaculous/rollover.js"></script>	
	<script type="text/javascript" src="../../scriptaculous/functions.js"></script>
	<script type="text/javascript" src="../../scriptaculous/sorttable.js"></script>
	<!--<script type="text/javascript" src="/jquery-1.2.2.pack.js"></script>-->
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="../../scriptaculous/jssor.slider.min.js"></script>

 	<link rel="stylesheet" type="text/css" href="../../featuredcontentglider.css" />
    <script type="text/javascript" src="../../featuredcontentglider.js"></script>

	</head>
	<body>
	<div id="mast_head">
		<a href="https://www.hdfgroup.org/"><img src="../../images/hdf_logo.jpg" height="70" style="display:block; padding-left:10px;" align="left" alt="hdf images" /></a>
		<img src="../../images/logo_5.jpg" height="70" style="display:block;" align="right" alt="hdf images" />
	</div> 
				
	<div id="nav_wrapper">
		<div>
		<div id="section-">
			<ul id="nav">
				<li id="t-index"><a href="https://www.hdfgroup.org/">Home</a> </li>
				<li id="t-products"><a href="../../products/index.html">Products</a></li>
				<li id="t-services"><a href="../../services/index.html">Services</a></li>
				<li id="t-about"><a href="../../about/index.html">About Us</a></li>
				<li id="t-news"><a href="../../news/index.html">News</a> </li>
				<li id="t-blog"><a href="https://www.hdfgroup.org/blog">Blog</a></li>
				<li id="t-contact"><a href="../../about/contact.html">Contact Us</a></li> 
			</ul>
			<script type="text/javascript">
			
  (function() {
    var cx = '007250492606109219119:sb2eg2bgoyy';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>	
					<script type="text/javascript">
					    jQuery(document).ready(function ($) {
					        // var options = {
					        //     $ArrowNavigatorOptions: {
					        //         $Class: $JssorArrowNavigator$,
					        //         $ChanceToShow: 2
					        //     }
					        // };					    	


							var options = { 
											$AutoPlay: true, $SlideshowOptions: { $Class: $JssorSlideshowRunner$, $Transitions: [{ $Duration:5000, $Fade: true, $Opacity:2 }] } , 
											$ArrowNavigatorOptions: { 
												$Class: $JssorArrowNavigator$, 
												$ChanceToShow: 2
											}
										  };


					        var jssor_slider1 = new $JssorSlider$('slider1_container', options);
					    });
					</script>
									                  
			
		</div>
		</div>             
	</div>
				
<!--START: MAIN -->
<div id="wrapper" style="margin-top:-15px;"> 

<!--START: SIDE_BAR -->
<div id="side_bar">

<form method="get" action="faq.html" class="form" >
	<select onchange="window.open(this.options[this.selectedIndex].value,'_top')" name="" style="border:2px solid #c1c1c1;">
		<option value="" class="ql1">- - Quick Links - -</option>
		<option value="/HDF5/" class="ql">HDF5</option>
		<option value="/products/hdf4/" class="ql">HDF4</option>
		<option value="/tools/" class="ql">Tools</option>
		<option value="/projects/" class="ql">Projects</option>
		<option value="/downloads/" class="ql">Downloads</option>
		<option value="/documentation/" class="ql">Documentation</option>
	        <option value="/pubs/" class="ql">Publications</option>
		<option value="/about/" class="ql">Contact Us</option>
	</select>
</form>
<ul style="border:1px solid #c1c1c1; margin-top:25px;"> 

	<li style="background:url(../../images/menubg.png); padding:0px; padding-left:7px; color:#27343C; font-weight:500; text-align:left;">
	LINKS</li><li><a href="../../products/hdf5/index.html">HDF5</a></li><li><a href="../../products/hdf4/index.html">HDF4</a></li><li><a href="../../tools/index.html">Tools</a></li><li><a href="../index.html">Projects</a></li><li><a href="../../downloads/index.html">Downloads</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul> 

</div>

<!--END: SIDE_BAR -->

<!--START: CONTENT -->
<div id="content">
<p><font color="red"><center><strong>This web site is no longer maintained (but will remain online).<br /> Please see The HDF Group's new <a href="https://portal.hdfgroup.org">Support Portal</a> for the latest information.</strong></center></font></p>
	<div class=bc><p style="color:orange; ";><a href="../../index.html" title="HOME">HOME</a> &gt; <a href="../index.html" title="PROJECTS">PROJECTS</a> &gt; <a href="index.html" title="PSH5X">PSH5X</a></p></div>                        <fieldset><h1>PSH5X Frequently Asked Questions</h1></fieldset>

<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>HDF Group - PSH5X FAQ</title>
        <link rel="stylesheet" type="text/css" href="style.css" />
    </head>
    <body>
        <a href="index.html"><img src="img/psh5x_logo_100x75.gif" alt="PSH5X logo" align="bottom"
             /></a>
        <h2>Introduction</h2>
        <h3>1.01 Where do I get help?</h3>
        <p>In PowerShell, the <tt>Get-Help</tt> cmdlet is your one-stop shop for help about cmdlets
            and topics. All PSH5X cmdlets come with some form of help. For example, to get help on
                <tt>New-H5Drive</tt> type <tt>help New-H5Drive</tt> or <tt>New-H5Drive -?</tt>. You
            can get a list of HDF5 related topics by typing <tt>help about_H5*</tt> .</p>
        <h3>1.02 What's the difference between between scripting languages and shell languages?</h3>
        <p>I keep returning to this question about every 3 months and an answer still eludes me. The
            following comment by <a href="http://manning.com/payette2/">Bruce Payette</a> has been a
            steady source of consolation (Windows PowerShell in Action, 2nd Edition, Manning 2011,
            page 7):</p>
        <q>In the end, there's no hard-and-fast distinction between a shell language and a scripting
            language. Some of the features that make a good scripting language result in a poor
            shell user experience. Conversely, some of the features that make for a good interactive
            shell experience can interfere with scripting. Because PowerShell's goal is to be both a
            good scripting language and a good interactive shell, balancing the tradeoffs between
            user experience and scripting authoring was one of the major language design
            challenges.</q>
        <h3>1.03 What datatypes are supported?</h3>
        <p>The ultimate goal is to support all datatypes. When we say 'support', we mean that data
            of that type can be represented in memory and on disk, and be read an written. The
            flexible JSON notation for HDF5 datatypes (see <tt>help about_H5Datatypes</tt>) lets one
            create HDF5 datasets, linked datatypes, and attributes of any HDF5 datatype. However,
            not all of them can be currently read or written. The process to get to a more complete
            support will be very much demand-driven. </p>
        <p>The table below gives an overview of what's supported in the current version.</p>
        <table>
            <thead>
                <tr>
                    <th>HDF5 Type Class</th>
                    <th>HDF5 Dataset</th>
                    <th>HDF5 Attribute</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><tt>H5T_INTEGER</tt></td>
                    <td>yes</td>
                    <td>yes</td>
                    <td> 1, 2, 4 or 8 byte, BE or LE, signed/unsigned</td>
                </tr>
                <tr>
                    <td><tt>H5T_FLOAT</tt></td>
                    <td>yes</td>
                    <td>yes</td>
                    <td> 4 or 8 byte, IEEE </td>
                </tr>
                <tr>
                    <td><tt>H5T_STRING</tt></td>
                    <td>yes</td>
                    <td>yes</td>
                    <td>Fixed- and variable-length, ASCII and UTF-8</td>
                </tr>
                <tr>
                    <td><tt>H5T_ENUM</tt></td>
                    <td>yes</td>
                    <td>yes</td>
                    <td> Must be derived from 1, 2, 4 or 8 byte, BE or LE, signed/unsigned integers.
                    </td>
                </tr>
                <tr>
                    <td><tt>H5T_BITFIELD</tt></td>
                    <td>yes</td>
                    <td>yes</td>
                    <td> 1, 2, 4 or 8 byte </td>
                </tr>
                <tr>
                    <td><tt>H5T_OPAQUE</tt></td>
                    <td>yes</td>
                    <td>no</td>
                    <td></td>
                </tr>
                <tr>
                    <td><tt>H5T_REFERENCE</tt></td>
                    <td>yes</td>
                    <td>yes</td>
                    <td>For attributes, only object references are supported.</td>
                </tr>
                <tr>
                    <td><tt>H5T_COMPOUND</tt></td>
                    <td>yes</td>
                    <td>no</td>
                    <td>Currently, members of class <tt>H5T_COMPOUND</tt> and <tt>H5T_VLEN</tt> are
                        not supported. Members of class <tt>H5T_ARRAY</tt> are supported, if they
                        are derived from a primitive type (e.g., integers, floats, strings
                        etc.)</td>
                </tr>
                <tr>
                    <td><tt>H5T_ARRAY</tt></td>
                    <td>yes</td>
                    <td>no</td>
                    <td>Currently, only array types derived from a primitive type (e.g., integers,
                        floats, strings etc.) are supported.</td>
                </tr>
                <tr>
                    <td><tt>H5T_VLEN</tt></td>
                    <td>yes</td>
                    <td>no</td>
                    <td>Currently, only variable-length sequence types derived from a primitive type
                        (e.g., integers, floats, strings etc.) are supported.</td>
                </tr>
            </tbody>
        </table>
        <h3>1.04 How do HDF5 compound datatypes "work" in PSH5X?</h3>
        <p>There are two parts to this question.</p>
        <h4>Reading data elements of an HDF5 compound datatype</h4>
        <p>The workflow for reading data elements from an HDF5 dataset is this:</p>
        <ol>
            <li>Parse the HDF5 datatype (in the file)</li>
            <li>Create a C# class whose instances (.NET objects) can be used to represent the data
                elements in memory</li>
            <li>Compile the code and load the .NET assembly into the running session</li>
            <li>Create a .NET array of the right size and shape</li>
            <li>Read the HDF5 dataset and intialize the array with the values read from disk</li>
            <li>Return the .NET array to the user</li>
        </ol>
        <p> There are several important details to this process. First, the code generation
            currently does not support deeply nested compound types. This is a matter of finding a
            good balance between demand (i.e., compound types that people really use) and having a
            maintainable code generator. Second, not all compound member names can be used as names
            of members in a .NET class. There are decorators such as <tt>PSNoteProperty</tt>, but we
            haven't finalized our approach. In the meantime, we use the type codes from the Python
                <tt>array</tt> module (e.g., <tt>H</tt> for a 16-bit unsigned integer) with a suffix
            indicating the rank of the member in the HDF5 compound. Let's look at an example. The
            compound type with this JSON definition:</p>
        <pre class="code">
{
    "Class": "Compound",
    "Size": 16,
    "Members":
    {
        "a": [0, "H5T_STD_I32BE"],
        "b": [4, "H5T_IEEE_F32BE"],
        "c": [8, "H5T_IEEE_F64BE"]
    }
}     
        </pre>
        <p>will be represented as follows:</p>
        <pre class="code">
using System;
public class ifd
{
    public System.Int32  i0;
    public System.Single f1;
    public System.Double d2;
    public ifd() { }
    public ifd(System.Int32 param0, System.Single param1, System.Double param2)
    { i0 = param0; f1 = param1; d2 = param2; }
}           
        </pre>
        <p> It'd be nice if there was an array package like <tt>NumPy</tt> for .NET. There appears
            to be a working 32-bit version, but not a 64-bit version. If you have any suggestions,
            please let us know! </p>
        <p>The <tt>Get-H5DatasetValue</tt> cmdlet currently does not support reading a subset of
            members of a compound type and it does not support type conversion (i.e., a
            single-prescision floating point number is read as just that; it doesn't convert it into
            a double). Both of these features will be supported in the release version of PSH5X.</p>
        <h4>Writing data elements of an HDF5 compound datatype</h4>
        <p>The workflow for writing data elements from an HDF5 dataset is this:</p>
        <ol>
            <li>Parse the HDF5 datatype in the file</li>
            <li>Reflect on the .NET type of the array elements in memory and determine if the member
                types can be converted to the matching member types on disk</li>
            <li>If successful, write the array to the HDF5 dataset</li>
        </ol>
        <p>Writing is simpler than reading, since no dynamic code generation is required. The
                <tt>Add-Type</tt> cmdlet gives the user ultimate control over the in-memory
            representation (and constructors) of the data elements. (See the <a
                href="tutorial.html">tutorial</a> for examples.)</p>
        <p>The <tt>Set-H5DatasetValue</tt> cmdlet currently does not support writing just a subset
            of compound members. This will be supported in the release version of PSH5X.</p>
        <p>To create an array of in-memory representations of an HDF5 datatype you have at least two
            options.</p>
        <ol>
            <li>Use <tt>Add-Type</tt> to add a .NET type followd by a <tt>New-Object</tt> to
                construct the array</li>
            <li>Use the <tt>New-H5Array</tt> cmdlet. Its first argument is the JSON type string and
                the array shape (dimensions) is its second argument.</li>
        </ol>
        <h2>The Windows Platform</h2>
        <h3 name="hdf52excel">2.01 How do I get data from HDF5 into Excel?</h3>
        <p>Assume that we have a 5553 (rows) by 86 (colums) twodimensional dataset of floating point
            numbers at <tt>h5:/my/floats</tt> that we would like to load into Excel. There's a
            simple four step process to get this done.</p>
        <ol>
            <li>Create an Excel COM object</li>
            <li>Add a blank workbook and select the target range</li>
            <li>Pump the values into the range</li>
            <li>Clean up</li>
        </ol>
        <p>The PowerShell skeleton is shown below. Note that you have to work out the corners of the
            range in Excel notation, e.g., A1-CH5554, which is well documented (check the links
            following the code).</p>
        <pre class="code">
# create an Excel COM object
$excel = New-Object -ComObject Excel.Application
$excel.Visible = $True

# add a workbook and select the target range
$workbook = $excel.Workbooks.Add() 
$range = $workbook.ActiveSheet.Range('A1','CH5554')

# pump the values in
$range.Value2 = Get-H5DatasetValue h5:/my/floats

# cleanup
$excel.Application.DisplayAlerts = $False
$excel.Quit()
Get-Process Excel | Stop-Process
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel)
        </pre>
        <p>Related information:</p>
        <ul>

            <li><a href="http://support.microsoft.com/kb/833402">How to convert Excel column numbers
                    into alphabetical characters</a></li>
            <li><a href="http://msdn.microsoft.com/en-us/library/ff846392.aspx">Excel 2010 Developer
                    Reference</a></li>
            <li><a
                    href="http://powertoe.wordpress.com/2010/11/05/how-to-get-data-into-an-excel-spreadsheet-very-quickly-with-powershell-contd/"
                    >How to Get Data into an Excel Spreadsheet Very Quickly with PowerShell</a></li>
            <li><a href="http://www.powershellpraxis.de/Excel-COM.982.0.html">PowerShell Excel (COM)
                    (in German)</a></li>
        </ul>
        <h3>2.02 Can I use ILNumerics in PowerShell?</h3>
        <p><b>Short answer:</b> Yes.</p>
        <p><b>Long answer:</b>
            <a href="http://ilnumerics.net/">ILNumerics</a> is a high performance math library for
            applications. Use the <tt>Add-Type</tt> cmdlet to load the ILNumerics assembly. You can
            then create ILNumerics .NET objects by casting or with the <tt>New-Object</tt>
            cmdlet.</p>
        <p>Use a package, such as <a href="http://pstx.codeplex.com/">PowerShell Type
                Accelerators</a> to make to code a littler easier to read and type.</p>
        <pre class="code">
Add-Type -Path E:\ILNumerics\ILNumerics_2.11.4464.29952\bin64\ILNumerics64.dll

Import-Module TypeAccelerator

Add-TypeAccelerator ilm   ILNumerics.ILMath

Add-TypeAccelerator ilf32 ILNumerics.ILArray[single]

# convert the value of an HDF5 dataset into an ILNumerics.ILArray&lt;Single&gt;

$il = [ilf32] (Get-H5DatasetValue 'aura:\HDFEOS\SWATHS\HIRDLS\Data Fields\Temperature')

# get the last column

$il[':;end']
        </pre>
        <p> The same is pretty much true for any .NET library. If such a library depends on HDF5,
            e.g., <a href="http://hdf5.net/">HDF5DotNet</a>, make sure that it was built against
            the same version of the HDF5 library as PSH5X. </p>
        <h2>Common HDF5 Tasks</h2>
        <h3>3.01 How do I save an XML file in HDF5?</h3>
        <p>There are several different ways of accomplishing that. Most are a variation on the
            following theme: Let's store the <tt>types.ps1xml</tt> file in a scalar string attribute
            of the HDF5 root group. We can store it as a variable-length or fixed-length string. By
            default, attributes are stored in compact form where their size must not exceed 64K. By
            comparision, a scalar dataset is not subject to that restriction.</p>
        <pre class="code">
$x = [string] (Get-Content "$($PSHOME)\types.ps1xml")

# variable-length, UTF-8 encoded string

New-H5Attribute h5tmp:\ vlen_str $x ustring

# in dense storage (default) the attribute size must not exceed 64K

$y = $x.Substring(0,64000)

New-H5Attribute h5tmp:\ fixed_str $y "ustring$($y.Length)"

New-H5Dataset h5tmp:\fixed_str "ustring$($x.Length)" -Scalar

Set-H5datasetValue h5tmp:\fixed_str $x            
        </pre>
        <p> Attributes can be larger than 64K if an object's attribute storage is dense. This
            property must be set at file/object creation time. </p>
        <h3>3.02 How do I save a binary file in HDF5?</h3>
        <p>There are several different ways of accomplishing that. Most are a variation on the
            following theme: Let's store the <a
                href="http://en.wikipedia.org/wiki/Notepad_(software)">Notepad</a> executable,
                <tt>notepad.exe</tt> in a scalar (singleton) HDF5 dataset of an HDF5 opaque type. </p>
        <pre class="code">
# get the file bytes
[byte[]] $x = Get-Content -Encoding byte -Path "$($env:windir)\System32\notepad.exe" -ReadCount 0

# create a scalar HDF5 dataset of an opaque type of the right size (193536 in Windows 7 64-bit)
New-H5Dataset h5tmp:\notepad.exe "opaque$($x.Count)['notepad.exe']" -Scalar

# pump the bytes in
Set-H5DatasetValue h5tmp:\notepad.exe (,$x)
        </pre>
        <p>The <tt>(,$x)</tt> on the last line is not a typo. <tt>Set-H5DatasetValue</tt> compares
            the size of the dataset with the value supplied. Since we are dealing with a scalar
            dataset, <tt>Set-H5DatasetValue</tt> expects a single value. Supplying <tt>$x</tt> as
            the value would create a size mismatch error, since it's an array of length greater than
            one. We must us the comma operator to turn it into a single element array whose only
            element is an array itself.</p>
    </body>
</html>

<i>
- - Last modified: 13 October 2016</i>
	   </div>
	   <!--END: CONTENT -->
<!--END: WRAPPER -->
<script src="../../scriptaculous/gatag.js" type="text/javascript"></script>

<!-- <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> -->
				
<!--
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3782034-1");
pageTracker._trackPageview();
} catch(err) {}</script>
-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3782034-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
