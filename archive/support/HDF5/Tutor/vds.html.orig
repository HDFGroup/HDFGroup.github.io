
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<!-- If no var is set for $page_title on the top of each page than default title will be HDF Group -->

<title>
The HDF Group - Information, Support, and Software</title>
	<meta name="keywords" content="hdf, hdfeos, blog, hdf blog, hdf5 blog, hdf5, hdf4, hdf tools, hdf libraries, hdf viewer, hdf format, hdf file, hdf java, nafxcw.lib, phdf5, open source, hierarchical data format, ncsa, database, python hdf, mike folk, hdfview, hdf5 parallel" />
	<meta name="description" content="The HDF Group is a not-for-profit corporation with the mission of sustaining the HDF technologies and supporting HDF user communities worldwide with production-quality software and services." />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="expires" content="Wed, 26 Feb 2010 08:21:57 GMT" />
	<meta name="verify-v1" content="/m03HNmaDgGAcDe0PFtEVnXGtCkoeOocjr/Jwey2gdI=" />
	<link href="/css/layout.css" rel="stylesheet" type="text/css" media="screen, projection" />
	<link href="/css/print.css" rel="stylesheet" type="text/css" media="print" />
	<link rel="stylesheet" type="text/css" href="/css/js_style.css" />
	<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/prototype/1.7.2.0/prototype.js"></script>
	<!--<script type="text/javascript" src="/scriptaculous/lib/prototype.js"></script>-->
	<script type="text/javascript" src="/scriptaculous/src/effects.js"></script>
	<script type="text/javascript" src="/scriptaculous/validation.js"></script>
	<script type="text/javascript" src="/scriptaculous/animatedcollapse.js"></script>
	<script type="text/javascript" src="/scriptaculous/rollover.js"></script>	
	<script type="text/javascript" src="/scriptaculous/functions.js"></script>
	<script type="text/javascript" src="/scriptaculous/sorttable.js"></script>
	<!--<script type="text/javascript" src="/jquery-1.2.2.pack.js"></script>-->
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="/scriptaculous/jssor.slider.min.js"></script>

 	<link rel="stylesheet" type="text/css" href="/featuredcontentglider.css" />
    <script type="text/javascript" src="/featuredcontentglider.js"></script>

	</head>
	<body>
	<div id="mast_head">
		<a href="https://www.hdfgroup.org/"><img src="/images/hdf_logo.jpg" height="70" style="display:block; padding-left:10px;" align="left" alt="hdf images" /></a>
		<img src="/images/logo_5.jpg" height="70" style="display:block;" align="right" alt="hdf images" />
	</div> 
				
	<div id="nav_wrapper">
		<div>
		<div id="section-">
			<ul id="nav">
				<li id="t-index"><a href="https://www.hdfgroup.org/">Home</a> </li>
				<li id="t-products"><a href="/products/">Products</a></li>
				<li id="t-services"><a href="/services/">Services</a></li>
				<li id="t-about"><a href="/about/">About Us</a></li>
				<li id="t-news"><a href="/news/">News</a> </li>
				<li id="t-blog"><a href="https://www.hdfgroup.org/blog">Blog</a></li>
				<li id="t-contact"><a href="/about/contact.html">Contact Us</a></li> 
			</ul>
			<script type="text/javascript">
			
  (function() {
    var cx = '007250492606109219119:sb2eg2bgoyy';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>	
					<script type="text/javascript">
					    jQuery(document).ready(function ($) {
					        // var options = {
					        //     $ArrowNavigatorOptions: {
					        //         $Class: $JssorArrowNavigator$,
					        //         $ChanceToShow: 2
					        //     }
					        // };					    	


							var options = { 
											$AutoPlay: true, $SlideshowOptions: { $Class: $JssorSlideshowRunner$, $Transitions: [{ $Duration:5000, $Fade: true, $Opacity:2 }] } , 
											$ArrowNavigatorOptions: { 
												$Class: $JssorArrowNavigator$, 
												$ChanceToShow: 2
											}
										  };


					        var jssor_slider1 = new $JssorSlider$('slider1_container', options);
					    });
					</script>
									                  
			
		</div>
		</div>             
	</div>
				
<!--START: MAIN -->
<div id="wrapper" style="margin-top:-15px;"> 

<!--START: SIDE_BAR -->
<div id="side_bar">

<form method="get" action="" class="form" >
	<select onchange="window.open(this.options[this.selectedIndex].value,'_top')" name="" style="border:2px solid #c1c1c1;">
		<option value="" class="ql1">- - Quick Links - -</option>
		<option value="/HDF5/" class="ql">HDF5</option>
		<option value="/products/hdf4/" class="ql">HDF4</option>
		<option value="/tools/" class="ql">Tools</option>
		<option value="/projects/" class="ql">Projects</option>
		<option value="/downloads/" class="ql">Downloads</option>
		<option value="/documentation/" class="ql">Documentation</option>
	        <option value="/pubs/" class="ql">Publications</option>
		<option value="/about/" class="ql">Contact Us</option>
	</select>
</form>
<ul style="border:1px solid #c1c1c1; margin-top:25px;"> 

	<li style="background:url(/images/menubg.png); padding:0px; padding-left:7px; color:#27343C; font-weight:500; text-align:left;">
	LINKS</li><li><a href="https://www.hdfgroup.org/">Main Website</a></li><li><a  href="/HDF5/whatishdf5.html">What is HDF5?</a></li><li><a  href="/about/HDF5Brochure_2012.pdf">Online Brochure</a></li><li><a  href="/downloads/index.html">Downloads</a></li><li><a  href="/HDF5/doc/index.html">Documentation</a></li><li><a  href="/products/hdf5_tools/">Software using HDF5</a></li><li><a  href="/HDF5/users5.html">HDF5 Users</a></li><li><a  href="/HDF5/hdf5-files.html">Sample HDF5 Files</a></li><li><a  href="/HDF5/acknowledge5.html">Acknowledgments</a></li><li><a  href="/products/licenses.html">Licenses</a></li></ul> 

</div>

<!--END: SIDE_BAR -->

<!--START: CONTENT -->
<div id="content">
<p><font color="red"><center><strong>This web site is no longer maintained (but will remain online).<br /> Please see The HDF Group's new <a href="https://portal.hdfgroup.org">Support Portal</a> for the latest information.</strong></center></font></p>
	<div class=bc><p style="color:orange; ";><a href="/" title="HOME">HOME</a> &gt; <a href="/HDF5/" title="HDF5">HDF5</a> &gt; <a href="/HDF5/Tutor/" title="TUTOR">TUTOR</a></p></div>
<fieldset><h1>HDF5 Tutorial: &nbsp; Virtual Dataset (VDS)</h1></fieldset>

<h2>Contents:</h2>

<ul class="ul">
<li class="li3"><a href="#desc">Introduction to the Virtual Dataset</a></li>
<li class="li3"><a href="#pm">Programming Model</a></li>
<li class="li3"><a href="#funcvds">Functions for Working with a VDS</a></li>
<li class="li3"><a href="#lim">Limitations</a></li>
<li class="li3"><a href="#pex">Programming Examples</a></li>
<li class="li3"><a href="#h5dump">Using h5dump with a VDS</a></li>
</ul>

<hr />

<a name ="desc"></a>
<h2>Introduction to the Virtual Dataset</h2>
<p>
The HDF5 Virtual Dataset (VDS) feature enables users to access data in a collection
of HDF5 files as a single HDF5 dataset and to use the HDF5 APIs to work
with that dataset. 
</p>
<p>
For example, your data may be collected into four files:
<p>
<img src="/images/tutrvds-multimgs.png" width=750></img>
</p>

<p>
You can map the datasets in the four files into a single VDS that can be accessed just 
like any other dataset:
</p>
<p>
<center>
<img src="/images/tutrvds-snglimg.png" width=500></img>
</center>
</p>

<!--
<p>
You can also view a subset of the image:
</p>

<p>
<ul class="ul">
<img src="/images/tutrvds-subset.png" width=250></img>
</ul>
</p>
-->


<p>
The mapping between a VDS and the HDF5 source datasets is persistent and transparent to an application.
If a source file is missing the fill value will be displayed.
</p>
<p>
See the <a href="/HDF5/docNewFeatures/NewFeaturesVirtualDatasetDocs.html">Virtual (VDS) Documentation</a> for complete details regarding the VDS feature.
</p>

<p>
The VDS feature was implemented using hyperslab selection (<a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectHyperslab">H5Sselect_hyperslab (C) /h5sselect_hyperslab_f (Fortran)</a>). See the tutorial on
<a href="./selectsimple.html">Reading From or Writing to a Subset of a Dataset</a> for more information
on selecting hyperslabs.

<a name="pm"></a>
<h2>Programming Model</h2>

<p>
To create a Virtual Dataset you simply follow the HDF5 programming model and add a few
additional API calls to map the source code datasets to the VDS.
</p> 
<p>
Following are the steps for creating a Virtual Dataset:
<ol class="ol">
<li>Create the source datasets that will comprise the VDS</li>
<li>Create the VDS:
  &dash; Define a datatype and dataspace (can be unlimited)<br />
  &dash; Define the dataset creation property list (including fill value)<br />
  &dash; (Repeat for each source dataset) Map elements from the source dataset to elements of the VDS:
     <ul class="ul">
      <li class="li3">Select elements in the source dataset (source selection)</li>
      <li class="li3">Select elements in the virtual dataset (destination selection)</li>
      <li class="li3">Map destination selections to source selections (see <a href="#funcvds">Functions for Working with a VDS</a>)</li>
     </ul>
  <br />
  &dash; Call H5Dcreate using the properties defined above
 </li>
<li>Access the VDS as a regular HDF5 dataset</li>
<li>Close the VDS when finished</li>
</ol>
</p>


<a name="funcvds"></a>
<h2>Functions for Working with a VDS</h2>

<p>
The <a href="/HDF5/doc/RM/RM_H5P.html#Property-SetVirtual">H5Pset_virtual</a> API sets the 
mapping between virtual and source datasets. This is a dataset creation property list. Using this API
will change the layout of the dataset to <font face="Courier">H5D_VIRTUAL</font>. As with specifying
any dataset creation property list, an instance of the property list is created, modified,   
passed into the dataset creation call and then closed:
<pre style="font-family:Consolas">
  <em>dcpl</em> = H5Pcreate (H5P_DATASET_CREATE); 
  
  src_space = H5screate_simple ...
  status = H5Sselect_hyperslab (space, ...       
  status = H5Pset_virtual (<em>dcpl</em>, space, SRC_FILE[i], SRC_DATASET[i], src_space);

  dset = H5Dcreate2 (file, DATASET, H5T_NATIVE_INT, space, H5P_DEFAULT, <em>dcpl</em>, H5P_DEFAULT);
 
  status = H5Pclose (<em>dcpl</em>);
</pre>
</p>

<p>
There are several other APIs introduced with Virtual Datasets, including query functions.  
For details see the complete list of 
<a href="/HDF5/docNewFeatures/NewFeaturesVirtualDatasetDocs.html#Hdf5LibraryApis">HDF5 Library APIs</a>
that support Virtual Datasets.
</p>


	 
<a name="lim"></a>
<h2>Limitations</h2>

<p> 
This feature requires HDF5-1.10.
<br />
The number of source datasets is unlimited. However, there is a limit on the size of each source dataset.
</p>


<a name="pex"></a>
<h2>Programming Examples</h2>
<p style="color:#004488;font-weight:bold">Example 1</p>

<p>
This example creates three HDF5 files, each with a one-dimensional dataset of 6 elements. The datasets
in these files are the source datasets that are then used to create a 4 x 6 Virtual Dataset with a
fill value of -1. The first three rows of the VDS are mapped to the data from the three source datasets
as shown below:
</p>
<p>
<center>
<img src="/images/tutrvds-ex.png" width=500></img>
</center>
</p>

<p>
In this example the three source datasets are mapped to the VDS with this code:
<pre style="font-family:Consolas">
    src_space = H5Screate_simple (RANK1, dims, NULL);
    for (i = 0; i < 3; i++) {
	start[0] = (hsize_t)i;
	/* Select i-th row in the virtual dataset; selection in the source datasets is the same. */
	status = H5Sselect_hyperslab (space, H5S_SELECT_SET, start, NULL, count, block);
	status = <span style="color:#004488;font-weight:bold">H5Pset_virtual</span> (dcpl, space, SRC_FILE[i], SRC_DATASET[i], src_space);
    }
</pre>
</p>

<p>
After the VDS is created and closed, it is reopened. The property list is then queried to determine the
layout of the dataset and its mappings, and the data in the VDS is read and printed.
</p>
<p>
This example is in the HDF5 source code and can be obtained from here:
</p>
<p>
<ul class="ul">
[ <a href="/ftp/HDF5/examples/110/h5_vds.c">C Example</a> ] - <span style="color:#004488;font-weight:bold">h5_vds.c</span>
</ul>
</p>
<p>
For details on compiling an HDF5 application:
[
<A HREF="./compile.html">Compile Information</A>
]
</p>

<p style="color:#004488;font-weight:bold">Example 2</p>
<p>
This example shows how to use a C-style <font face="Courier">printf</font> statement for
specifying multiple source datasets as one virtual dataset. Only one mapping is required. In other
words only one 
<a href="/HDF5/doc/RM/RM_H5P.html#Property-SetVirtual">H5Pset_virtual</a> 
call is needed to map multiple datasets. It creates a 2-dimensional unlimited VDS. Then it 
re-opens the file, makes queries, and reads the virtual dataset.
</p>
<p>
The source datasets are specified as <font face="Courier">A-0</font>, <font face="Courier">A-1</font>, <font face="Courier">A-2</font>, 
and <font face="Courier">A-3</font>. These are mapped to the virtual dataset with one
call:
<p style="font-family:Consolas">
&nbsp; &nbsp;  status = H5Pset_virtual (dcpl, vspace, SRCFILE, "/A-%b", src_space);
</p>
<p>
The <font face="Courier">%b</font> indicates that the block count of the selection in the dimension should be
used.
</p>

<p>
<ul class="ul">
[ <a href="/ftp/HDF5/examples/110/h5_vdsunl.c">C Example</a> ] - <span style="color:#004488;font-weight:bold">h5_vdsunl.c</span>
</ul>
</p>
<p>
For details on compiling an HDF5 application:
[
<A HREF="./compile.html">Compile Information</A>
]
</p>



<a name="h5dump"></a>
<h2>Using h5dump with a VDS</h2>

<p>
The <font face="Courier">h5dump</font> utility can be used to view a VDS. The
<font face="Courier">h5dump</font> output for a VDS looks exactly like that
for any other dataset. If <font face="Courier">h5dump</font> cannot find a source
dataset then the fill value will be displayed.
</p>
<p>
You can determine that a dataset is a VDS by looking at its properties with 
<font face="Courier">h5dump -p</font>. It will display each source dataset mapping,
beginning with <em>Mapping 0</em>. Below is an excerpt of the output of 
<font face="Courier">h5dump -p</font> on the <font face="Courier">vds.h5</font> file created 
in Example 1.You can see that the entire source file <font face="Courier">a.h5</font> is mapped 
to the first row of the <font face="Courier">/VDS</font> dataset:
</p>

&nbsp; &nbsp; &nbsp; &nbsp; <img src="/images/tutrvds-map.png" width=600>



<hr>
<i>
- - Last modified: 02 May 2017</i>
	   </div>
	   <!--END: CONTENT -->
<!--END: WRAPPER -->
<script src="/scriptaculous/gatag.js" type="text/javascript"></script>

<!-- <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> -->
				
<!--
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3782034-1");
pageTracker._trackPageview();
} catch(err) {}</script>
-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3782034-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
