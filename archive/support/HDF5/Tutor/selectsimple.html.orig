
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<!-- If no var is set for $page_title on the top of each page than default title will be HDF Group -->

<title>
The HDF Group - Information, Support, and Software</title>
	<meta name="keywords" content="hdf, hdfeos, blog, hdf blog, hdf5 blog, hdf5, hdf4, hdf tools, hdf libraries, hdf viewer, hdf format, hdf file, hdf java, nafxcw.lib, phdf5, open source, hierarchical data format, ncsa, database, python hdf, mike folk, hdfview, hdf5 parallel" />
	<meta name="description" content="The HDF Group is a not-for-profit corporation with the mission of sustaining the HDF technologies and supporting HDF user communities worldwide with production-quality software and services." />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="expires" content="Wed, 26 Feb 2010 08:21:57 GMT" />
	<meta name="verify-v1" content="/m03HNmaDgGAcDe0PFtEVnXGtCkoeOocjr/Jwey2gdI=" />
	<link href="/css/layout.css" rel="stylesheet" type="text/css" media="screen, projection" />
	<link href="/css/print.css" rel="stylesheet" type="text/css" media="print" />
	<link rel="stylesheet" type="text/css" href="/css/js_style.css" />
	<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/prototype/1.7.2.0/prototype.js"></script>
	<!--<script type="text/javascript" src="/scriptaculous/lib/prototype.js"></script>-->
	<script type="text/javascript" src="/scriptaculous/src/effects.js"></script>
	<script type="text/javascript" src="/scriptaculous/validation.js"></script>
	<script type="text/javascript" src="/scriptaculous/animatedcollapse.js"></script>
	<script type="text/javascript" src="/scriptaculous/rollover.js"></script>	
	<script type="text/javascript" src="/scriptaculous/functions.js"></script>
	<script type="text/javascript" src="/scriptaculous/sorttable.js"></script>
	<!--<script type="text/javascript" src="/jquery-1.2.2.pack.js"></script>-->
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="/scriptaculous/jssor.slider.min.js"></script>

 	<link rel="stylesheet" type="text/css" href="/featuredcontentglider.css" />
    <script type="text/javascript" src="/featuredcontentglider.js"></script>

	</head>
	<body>
	<div id="mast_head">
		<a href="https://www.hdfgroup.org/"><img src="/images/hdf_logo.jpg" height="70" style="display:block; padding-left:10px;" align="left" alt="hdf images" /></a>
		<img src="/images/logo_5.jpg" height="70" style="display:block;" align="right" alt="hdf images" />
	</div> 
				
	<div id="nav_wrapper">
		<div>
		<div id="section-">
			<ul id="nav">
				<li id="t-index"><a href="https://www.hdfgroup.org/">Home</a> </li>
				<li id="t-products"><a href="/products/">Products</a></li>
				<li id="t-services"><a href="/services/">Services</a></li>
				<li id="t-about"><a href="/about/">About Us</a></li>
				<li id="t-news"><a href="/news/">News</a> </li>
				<li id="t-blog"><a href="https://www.hdfgroup.org/blog">Blog</a></li>
				<li id="t-contact"><a href="/about/contact.html">Contact Us</a></li> 
			</ul>
			<script type="text/javascript">
			
  (function() {
    var cx = '007250492606109219119:sb2eg2bgoyy';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>	
					<script type="text/javascript">
					    jQuery(document).ready(function ($) {
					        // var options = {
					        //     $ArrowNavigatorOptions: {
					        //         $Class: $JssorArrowNavigator$,
					        //         $ChanceToShow: 2
					        //     }
					        // };					    	


							var options = { 
											$AutoPlay: true, $SlideshowOptions: { $Class: $JssorSlideshowRunner$, $Transitions: [{ $Duration:5000, $Fade: true, $Opacity:2 }] } , 
											$ArrowNavigatorOptions: { 
												$Class: $JssorArrowNavigator$, 
												$ChanceToShow: 2
											}
										  };


					        var jssor_slider1 = new $JssorSlider$('slider1_container', options);
					    });
					</script>
									                  
			
		</div>
		</div>             
	</div>
				
<!--START: MAIN -->
<div id="wrapper" style="margin-top:-15px;"> 

<!--START: SIDE_BAR -->
<div id="side_bar">

<form method="get" action="" class="form" >
	<select onchange="window.open(this.options[this.selectedIndex].value,'_top')" name="" style="border:2px solid #c1c1c1;">
		<option value="" class="ql1">- - Quick Links - -</option>
		<option value="/HDF5/" class="ql">HDF5</option>
		<option value="/products/hdf4/" class="ql">HDF4</option>
		<option value="/tools/" class="ql">Tools</option>
		<option value="/projects/" class="ql">Projects</option>
		<option value="/downloads/" class="ql">Downloads</option>
		<option value="/documentation/" class="ql">Documentation</option>
	        <option value="/pubs/" class="ql">Publications</option>
		<option value="/about/" class="ql">Contact Us</option>
	</select>
</form>
<ul style="border:1px solid #c1c1c1; margin-top:25px;"> 

	<li style="background:url(/images/menubg.png); padding:0px; padding-left:7px; color:#27343C; font-weight:500; text-align:left;">
	LINKS</li><li><a href="https://www.hdfgroup.org/">Main Website</a></li><li><a  href="/HDF5/whatishdf5.html">What is HDF5?</a></li><li><a  href="/about/HDF5Brochure_2012.pdf">Online Brochure</a></li><li><a  href="/downloads/index.html">Downloads</a></li><li><a  href="/HDF5/doc/index.html">Documentation</a></li><li><a  href="/products/hdf5_tools/">Software using HDF5</a></li><li><a  href="/HDF5/users5.html">HDF5 Users</a></li><li><a  href="/HDF5/hdf5-files.html">Sample HDF5 Files</a></li><li><a  href="/HDF5/acknowledge5.html">Acknowledgments</a></li><li><a  href="/products/licenses.html">Licenses</a></li></ul> 

</div>

<!--END: SIDE_BAR -->

<!--START: CONTENT -->
<div id="content">
<p><font color="red"><center><strong>This web site is no longer maintained (but will remain online).<br /> Please see The HDF Group's new <a href="https://portal.hdfgroup.org">Support Portal</a> for the latest information.</strong></center></font></p>
	<div class=bc><p style="color:orange; ";><a href="/" title="HOME">HOME</a> &gt; <a href="/HDF5/" title="HDF5">HDF5</a> &gt; <a href="/HDF5/Tutor/" title="TUTOR">TUTOR</a></p></div>
<fieldset><h1>HDF5 Tutorial: &nbsp; Learning The Basics<br />
Reading from or Writing to a Subset of a Dataset</h1></fieldset>

<h2>Contents:</h2>
<ul class="ul">
    <li><p><a HREF="#def">Reading from or Writing to a Subset of a Dataset</a></p></li>
    <li><p>Programming Example (C, Fortran, C++):</p>
     <ul class="ul">
      <li class="li3"> <a href="#desc">Description</a></li> 
      <li class="li3"><a href="#exp">Experiments with Different Selections</a></li>
      <li class="li3"><a href="#rem">Remarks</a> </li>
     </li>
</ul>
</ul>

<hr />

<A NAME="def"> </a>

<h2>Reading from or Writing to a Subset of a Dataset</h2>

<p>
HDF5 allows you to read from or write to a portion or subset of a dataset. This
is done by selecting a subset of the dataset's dataspace in the file, selecting a memory dataspace, and then using 
the memory and file dataspaces to read from or write to the dataset.
</p>
<p>
 There are two types of selections in HDF5, hyperslab selections and
element selections, specified with the <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectHyperslab">H5Sselect_hyperslab (C) / h5sselect_hyperslab_f (Fortran)</a> and <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectElements">H5Sselect_elements (C) /h5sselect_elements_f (Fortran)</a> calls,
respectively:
</p>

<ul class="ul">
<li class="li3">
<p> 
The <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectHyperslab">H5Sselect_hyperslab (C) / h5sselect_hyperslab_f (Fortran)</a> call 
selects a logically contiguous collection of points in a dataspace,
or a regular pattern of points or blocks in a dataspace.  
</p>
</li>
<li class="li3">
<p>
The <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectElements">H5Sselect_elements (C) /h5sselect_elements_f (Fortran)</a> call selects elements
in an array.
</p>
</li>
</ul>

<p>This tutorial topic shows how to write to a simple subset of data in a
dataset. 
See the Advanced Tutorial topics for a more complex example and an example
of using element selection.
</p>

<p style="color:#2A5454; font-size:130%;">Selecting a Subset of the Dataset's Dataspace</p>

<p>
The <a href="/HDF5/doc/RM/RM_H5D.html#Dataset-GetSpace">H5Dget_space / h5dget_space_f</a> call 
obtains the dataspace of a dataset in a file.
</p>

<p>A subset of that dataspace can be selected with <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectHyperslab">H5Sselect_hyperslab (C) / h5sselect_hyperslab_f (Fortran)</a>. 
The  <em>offset</em>, <em>count</em>, <em>stride</em> and
<em>block</em> parameters of this API 
define the shape and size of the selection.  They must be arrays with the
same number of dimensions
as the rank of the dataset's dataspace.  These arrays <strong>ALL</strong> work
together to define a selection.  A change to one of these arrays
can affect the others.
</p>
<p>
The <em>offset</em> or <em>start</em> array specifies the offset of the starting element of the specified hyperslab.
</p>

<p>
The <em>count</em> array determines how many blocks to select from the dataspace in each dimension. If the block size
for a dimension is one then the <em>count</em> is the number of elements along that dimension.
</p>

<p>
The <em>stride</em> array allows you to sample elements along a dimension. For example, a stride of one (or NULL) 
will select every element along a dimension, a stride of two will select every other element, and a stride of 
three will select an element after every two elements. 
</p>

<p>
The <em>block</em> array determines the size of the element block selected from a dataspace. If the
block size is one or NULL then the block size is a single element in that dimension.
</p>

<p style="color:#2A5454; font-size:130%;">Selecting a Memory Dataspace</p>
<p>
You must select a memory dataspace in addition to a file dataspace before you can read a subset from or write a subset to a dataset.  
A memory dataspace can be specified by
calling <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-CreateSimple">H5Screate_simple (C) / h5screate_simple_f (Fortran)</a>.
</p>

<p>
The memory dataspace passed to the read or write call must contain the same number of elements as the file dataspace.
The number of elements in a dataspace selection can be determined with the  
<a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectNpoints">H5Sget_select_npoints (C) / h5sget_select_npoints_f (Fortran)</a> 
API.
</p>

<p style="color:#2A5454; font-size:130%;">Reading From or Writing To a Dataset Subset</p>
<p>
To read from or write to a dataset subset, the <a href="/HDF5/doc/RM/RM_H5D.html#Dataset-Read">H5Dread (C) /h5dread_f (Fortran)</a> 
and <a href="/HDF5/doc/RM/RM_H5D.html#Dataset-Write">H5Dwrite (C) / h5dwrite_f (Fortran)</a> routines are used.  
The memory and file dataspace identifiers from the selections that were made are passed into the read or write call. For example (C):
</p>
<p>
<pre>
    status = H5Dwrite (.., .., memspace_id, dataspace_id, .., ..);
</pre>
</p>


<p>
<H2> Programming Example</H2>
<A NAME="desc"></a>
<p style="color:#2A5454;font-size:130%;">Description</p>      
<p>
This example (for C and C++) creates an 8 x 10 integer dataset in an HDF5 file.  It then selects and writes to a 3 x 4
subset of the dataset created with the dimensions offset by 1 x 2. (If using Fortran, the dimensions 
will be swapped. The dataset will be 10 x 8, the subset will be 4 x 3, and the offset will be 2 x 1.)
</p>

<p>
PLEASE NOTE that the examples and images below were created using C. 
</p>

<p>
The following image shows the dataset that gets written originally, and the subset of data 
that gets modified afterwards. Dimension 0 is vertical and Dimension 1 is horiziontal as shown below:
</p>

<p>
<table style="border:none;">
<tr style="border:none;">
<td style="border:none;">
<img src ="/images/tutr-subset5.png" width=350></img>
<img src ="/images/tutr-subset4.png" width=350></img>
</td>
</tr>
</table>
</p>

<p>
The subset on the right above is created using these values for
offset, count stride, and block:
</p>

<p>
<ul class="ul">
    offset = {1, 2}<br />
    count = {3, 4} <br />
    stride = {1, 1}<br />
    block = {1, 1}</br />
</ul>
</p>




<p>
To obtain the example, download:
<ul class="ul">
[ <A HREF="/ftp/HDF5/current/src/unpacked/examples/h5_subset.c">C example</a> ] - <code>h5_subset.c</code><br />
[ <A HREF="/ftp/HDF5/current/src/unpacked/fortran/examples/h5_subset.f90">F90 example</a> ] - <code>h5_subset.f90</code><br />
[ <A HREF="/ftp/HDF5/current/src/unpacked/c++/examples/h5tutr_subset.cpp">C++ example</a> ] - <code>h5tutr_subset.cpp</code><br />
</ul>
</p>

<p>
See <a href="/HDF5/examples/intro.html">HDF5 Introductory Examples</a>
for the examples used in the Learning the Basics tutorial. There are examples for several other languages.
</p>

<p>
For details on compiling an HDF5 application, click
<strong><a href="./compile.html">here</A></strong>.            
</p>

<a name="exp"> </a>
<p style="color:#2A5454; font-size:130%;">Experiments with Different Selections</p>

<p>
Following are examples of changes that can be made to the example code provided
to better understand how to make selections.
</p>

<p><strong>Example 1:</strong></p>
<p>
By default the example code will select and write to a 3 x 4 subset. You can modify 
the  <em>count</em> parameter in the example code to select a different subset, by changing 
the value of DIM0_SUB (C, C++) / dim0_sub (Fortran) near the top. Change its
value to 7 to create a 7 x 4 subset:

</p>
<p>
<img src ="/images/tutr-subset6.png" width=500>
</p>

<p>
If you were to change the subset to 8 x 4, the selection would be beyond the extent of the dimension:
</p>
<p>
<img src ="/images/tutr-subset7.png" width=500>
</p>

<p>
The write will fail with the error:
<strong>"file selection+offset not within extent"</strong>
</p>

<p><strong>Example 2:</strong></p>
In the example code provided, the memory and file dataspaces passed to the H5Dwrite call have the
same size, 3 x 4 (DIM0_SUB x DIM1_SUB). Change the size of the memory dataspace to be 4 x 4 so that
they do not match, and then compile:
</p>
<p>
<pre>
    dimsm[0] = DIM0_SUB + 1;
    dimsm[1] = DIM1_SUB;
    memspace_id = H5Screate_simple (RANK, dimsm, NULL); 
</pre>
</p>
<p>
The code will fail with the error:
<strong>"src and dest data spaces have different sizes"</strong>
</p>
<p>
How many elements are in the memory and file dataspaces that were specified above?
Add these lines:
<pre>
    hssize_t    size;
  
    /* Just before H5Dwrite call the following */
    size = H5Sget_select_npoints (memspace_id);
    printf ("\nmemspace_id size: %i\n", size);
    size = H5Sget_select_npoints (dataspace_id);
    printf ("dataspace_id size: %i\n", size);
</pre>
</p>

<p>
You should see these lines followed by the error:
<pre>
    memspace_id size: 16
    dataspace_id size: 12
</pre>
</p>



<p><strong>Example 3:</strong></p>

 <p>
This example shows the selection that occurs if changing the values of the  <em>offset</em>, <em>count</em>, 
<em>stride</em> and <em>block</em> parameters in the example code.
</p>
<p>
This will select two blocks. The <em>count</em> array specifies the number of blocks. The 
<em>block</em> array specifies the size of a block. The <em>stride</em> must be modified to accomodate
the block size. 

<p>
<img src ="/images/tutr-subset1.png" width=500>
</p>
<p>
Now try modifying the <em>count</em> as shown below. The write will fail because the selection goes beyond the extent of the dimension:
</p>
<p>
<img src ="/images/tutr-subset2.png" width=500>
</p>
<p>
If the offset were 1x1 (instead of 1x2), then the selection can be made:
</p>
<p>
<img src ="/images/tutr-subset3.png" width=500>
</p>

<p>
The selections above were tested with the <a href="/ftp/HDF5/examples/howto/subset/h5_subsetbk.c">h5_subsetbk.c</a> example code. The memory dataspace was defined as 
one-dimensional.  </p>


<A NAME="rem"></a>
<p style="color:#2A5454; font-size:130%;">Remarks</p>
<ul class="ul">
<li class="li3"><p>In addition to <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectHyperslab">H5Sselect_hyperslab / h5sselect_hyperslab_f</a>, 
this example introduces the
    <a href="/HDF5/doc/RM/RM_H5D.html#Dataset-GetSpace">H5Dget_space / h5dget_space_f</a> call to obtain the dataspace of a dataset.
</p>
</li>
<li class="li3"><p>If using the default values for the <em>stride</em>
and <em>block</em> parameters of <a href="/HDF5/doc/RM/RM_H5S.html#Dataspace-SelectHyperslab">H5Sselect_hyperslab / h5sselect_hyperslab_f</a>, 
then, for C you can specify NULL for these parameters, rather than passing in an
array for each, and for Fortran 90 you can omit these parameters.
</li>

</ul>




<hr />
<i>
- - Last modified: 21 December 2016</i>
	   </div>
	   <!--END: CONTENT -->
<!--END: WRAPPER -->
<script src="/scriptaculous/gatag.js" type="text/javascript"></script>

<!-- <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> -->
				
<!--
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3782034-1");
pageTracker._trackPageview();
} catch(err) {}</script>
-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3782034-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>



