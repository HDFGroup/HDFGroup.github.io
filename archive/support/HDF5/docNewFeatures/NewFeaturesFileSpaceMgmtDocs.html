<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN"
        "http://www.w3.org/TR/html4/frameset.dtd">
<html>
  <head>

<!--
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  * Copyright by The HDF Group.                                               *
  * Copyright by the Board of Trustees of the University of Illinois.         *
  * All rights reserved.                                                      *
  *                                                                           *
  * This file is part of HDF5.  The full HDF5 copyright notice, including     *
  * terms governing use, modification, and redistribution, is contained in    *
  * the files COPYING and Copyright.html.  COPYING can be found at the root   *
  * of the source code distribution tree; Copyright.html can be found at the  *
  * root level of an installed copy of the electronic HDF5 document set and   *
  * is linked from the top-level documents page.  It can also be found at     *
  * http://hdfgroup.org/HDF5/doc/Copyright.html.  If you do not have          *
  * access to either file, you may request a copy from help@hdfgroup.org.     *
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 -->

<link href="https://support.hdfgroup.org/HDF5/docNewFeatures/ed_styles/RMelect.css" rel="stylesheet" type="text/css">
    <title>
      HDF5 File Space Management Documentation
    </title>
  </head>

<body bgcolor="#ffffff">

<font face="Tahoma, Arial, Verdana, Helvetica, sans-serif" size="3">

<!-- BEGIN MAIN BODY -->



<table width="100%" cellpadding="0" border="0"> 
  <tr valign="top" align="left">
    <td>
      <a href="http://www.hdfgroup.org">
      <img src="Graphics/THGnoTextSm.jpg" alt="The HDF Group logo" 
        border="0" width="75"></a>
        <font size="+2">The HDF Group</font>
        </td>
    <td align="right">
      <img src="Graphics/binder.jpg" alt="Documentation" 
        border="0" height="60">
        </td></tr>

<!--    #888888 is a dark gray (dark gray horizontal line under logo 
        at top of web page. 
        #004488 is a dark blue (dark horizontal line at top of web pages). 
        #d2e6ef is a pale bluish gray or grayish aqua (nav bar background).
        #fbfbfb is almost white (background for nav bar links) 
        and is very close to #FFFFFF. 
        #FF0000 is a bright red (use when troubleshooting).
-->

<tr><td colspan="2" bgcolor="#888888" height="3"></td></tr>

<tr><td colspan="2" bgcolor="#004488" height="7" valign="bottom">&nbsp;
<!--
<font face="Tahoma, Arial, Verdana, Helvetica, sans-serif" size="3">&nbsp;</font>
-->
</td></tr>

</table>

<table border="0" width="100%" cellpadding="5">
<!-- change border value from 1 to 0 when finished editing 2.18.2014 -->
<tr><td rowspan="3" width="13%" bgcolor="#d2e6ef" valign="top" align="left">
&nbsp;<br />
<center>
<table border="0" cellpadding="10">
<tr><td bgcolor="#fbfbfb">
    <center><font size="+1">Other HDF Links</font></center>
    <hr />
    <font size="-1">
    <dl>

    <dt><a href="../doc.html"
        target="ExtWin">HDF5 1.10 Documentation</a></dt><br />
    <dt align="center"><hr size=4 color="gray">
        <a href="index.html">New Features in HDF5 1.10</a>
        <hr size=1>
        </dt>
    <dt><a href="NewFeaturesAdditionalNewFuncsEtc.html">
        Additional New APIs</a>
        </dt><br />
    <dt><a href="NewFeaturesCollectiveMetadataIoDocs.html">
        Collective Metadata I/O</a>
        </dt><br />
    <dt><a href="NewFeaturesFineTuningMetadataCacheDocs.html">
        Fine-tuning the Metadata Cache</a>
        </dt><br />
    <dt><a href="NewFeaturesFileSpaceMgmtDocs.html">
        File Space Management</a>
        </dt><br />
    <dt><a href="NewFeaturesPageBuffering.html">
        Page Buffering</a>
        </dt><br />
    <dt><a href="NewFeaturesPartialEdgeChunkDocs.html">
        Partial Edge Chunks</a>
        </dt><br />
    <dt><a href="NewFeaturesReferenceDocs.html">
        Reference</a>
        </dt><br />
    <dt><a href="NewFeaturesSwmrDocs.html">
        SWMR</a>
        </dt><br />
    <dt><a href="NewFeaturesVirtualDatasetDocs.html">
        Virtual Datasets (VDS)</a>

    </dl>
    </font>
    </td></tr></table></center>
    </td></tr>



<!-- 
The table data element below sets up the middle column 
between the navigation frame on the left and the content of the 
web page.
-->
<td rowspan="3" bgcolor="#FFFFFF" width="2%">&nbsp;</td>



<!-- 
The table data element below is used to hold the content of the 
web page. 
-->
<td bgcolor="#FFFFFF" valign="top" align="center" width="85%">

<table border="0" width="100%">
<tr>
<td bgcolor="#fbf3ef" align="center" valign="top" colspan="2">
    <hr size="1"/>
    <font size="5" color="#000000">File Space Management
    Documentation
    </font>
    <hr size="1"/>
    </td>
</tr>




<tr>
<td bgcolor="#FFFFFF" align="left" valign="top" colspan="2">
<!--
    <font size=5 color=#004488>Page Abstract</font>
    <br />
-->
    The purpose of this page is to list and briefly describe the 
    documentation available to those who will use the 
    file space management feature found in the 
    HDF5 library. 
    <p />
    The HDF5 library's file space management activities encompass both the allocation of file 
    space and the management of free space.  When an HDF5 object (group, dataset, etc.) is created
    and written, file space is allocated for storing its metadata and raw data.  When an object is
    removed, the space associated with the object becomes free space.
    <p />
    The following are the sections on this page:
    
    <ul>
    <li><a href="NewFeaturesFileSpaceMgmtDocs.html#strat">File Space Management Strategies</a></li>
    <li>
<!--
        <a href="#FileSpaceManagement">File Space Management 
        User&rsquo;s Guide</a>
-->
File Space Management User&rsquo;s Guide
<font color="aaaaaa"><i>
&nbsp;(not yet available)
</i></font>
        </li>
    <li><a href="NewFeaturesFileSpaceMgmtDocs.html#Hdf5LibraryApis">HDF5 Library APIs</a></li>
    <li><a href="NewFeaturesFileSpaceMgmtDocs.html#Tools">Tools</a></li>
<!--
    <li><a href="#FileSpaceDesignDocuments">File Space Management
        Design Documents</a></li>
-->
    </ul>
    
    
    
    
    
<!--    
    The user&rsquo;s guide is listed first. 
    New APIs and tools are being developed for 
    the 1.10 release. These are listed in the &ldquo;HDF5 
    Library APIs&rdquo; and &ldquo;Tools&rdquo; sections below.
    For background information, see the design documents listed 
    in the &ldquo;SWMR Design&rdquo; section
-->
    </td>
</tr>



<tr>
<td bgcolor="#FFFFFF" valign="top" align="center" colspan="2">
    &nbsp;</td></tr>

<tr>
<td bgcolor="#FFFFFF" align="left" valign="top" colspan="2">
    <font size="5" color="#004488"><a name="strat">
    File Space Management Strategies</a></font>
    </td></tr>

<tr>
    <td align="left" valign="top" colspan="2">
    <p>
    The HDF5 library uses three mechanisms to manage space in an HDF5 file. They
    are:
    <ul class="ul">
     <li class="li">
       Free-space managers that track free-space sections of various sizes in the file that
       are not currently allocated.
     </li>
     <li class="li">
      Aggregators, which are contiguous blocks of free space in the file.
      </li>
     <li class="li">
      Virtual file drivers, which use the virtual file driver interface to request 
      additional space from the file driver associated with the file.
     </li>
    </ul>
   </td>
</tr> 

<tr>
    <td align="left" valign="top" colspan="1">
There are four file space-handling strategies available to users that use these
mechanisms:
</td>
</tr>
    
<tr>
    <td align="left" valign="top" colspan="2">

<p>
    <font size="4" color="#004488">H5F_FSPACE_STRATEGY_FSM_AGGR</font>
</p>

<p>
This strategy has always been available in HDF5 and is the default.
The mechanisms used for this strategy are free-space managers, aggregators, and virtual
file drivers.
</p>
</td>
</tr>

<tr>
    <td align="left" valign="top" colspan="2">
<p>
    <font size="4" color="#004488">H5F_FSPACE_STRATEGY_PAGE</font>
</p>

    <p>
     The current HDF5 file space allocation accumulates small pieces of metadata and raw data in
    aggregator blocks.  However, these blocks are not page aligned and vary widely in sizes. The
    paged aggregation feature provides efficient paged access of these small pieces of metadata and
    raw data. It accumulates metadata and raw data into well-aligned pages called file space pages.
    The library defines a default file space page size but a user can set the page size via a new public
    routine.
    </p>
    <p>The mechanisms used for this strategy are free-space managers with embedded paged aggregation
    and virtual file drivers.
    </p>
    <p>
    See the <a href="FileSpace/RFC-Paged_Aggregation.pdf">RFC</a> on this feature for complete details.
    </p>
</td>
</tr>
<tr>
  <td align="left" valign="top" colspan="2">
    <font size="4" color="#004488">H5F_FSPACE_STRATEGY_AGGR</font>
<p>
With this strategy the library will request space from either the metadata or raw data aggregator
depending on the file space type. If the request is not satisfied, the library will request space
from the virtual file driver.
<p>
The mechanisms used for this strategy are aggregators and virtual file drivers.
It does not use the free-space manager.
</p>
</td>
</tr>
<tr>
  <td align="left" valign="top" colspan="2">
    <font size="4" color="#004488">H5F_FSPACE_STRATEGY_NONE</font>
<p>
This strategy will request space from the virtual file driver.  The only mechanism used is the virtual file driver.
It does not use the free-space manager.
</p>
</td>
</tr>
<tr>
<td bgcolor="#FFFFFF" align="left" valign="top" colspan="2">
<p>
</td>
</tr>


<tr>
<td bgcolor="#FFFFFF" align="left" valign="top" colspan="2">
    <font size="5" color="#004488"><a name="FileSpaceManagement">
    File Space Management User&rsquo;s Guide</a></font>
    </td></tr>



<tr>
    <td align="left" valign="top" colspan="2">
<font color="aaaaaa"><i>
(This document is not yet available.)
</i></font>
<!--
    &ldquo;<a href="FileSpace/FileSpaceManagement.pdf"><em>HDF5 
    File Space Management</em></a>&rdquo;
    describes the HDF5 File Space Management feature and 
    how to use it.  This feature allows the user to specify
    the file space management strategies available in HDF5
    to affect file size and access time for various HDF5 
    file usage patterns. 
-->
    </td>
</tr>



<tr>
<td bgcolor="#FFFFFF" valign="top" colspan="2">
    &nbsp;</td></tr>



<tr>
<td bgcolor="#FFFFFF" valign="top" colspan="2">
    <br />
    <font size="5" color="#004488"><a name="Hdf5LibraryApis">
    HDF5 Library APIs</a></font>
    </td></tr>



<tr>
    <td align="left" valign="top" colspan="2">
    The APIs listed below from the <i>HDF5 Reference Manual</i> 
    provide a means for users to directly manage the file space
    management feature.
    </td>
</tr>



<!-- start nested table -->
<tr><td><table>
<tr><td bgcolor="#FFFFFF" colspan="3">&nbsp;</td></tr>



<tr>
    <td valign="top" width="25%">
    <a href="../doc/RM/RM_H5F.html#File-GetFreeSections">
    <code>H5Fget_free_sections</code></a>
    </td>
    <td valign="top" width="3%">
    &nbsp;
    </td>
    <td valign="top" width="72%">
    Retrieves free-space section information for a file.
    </td>
</tr>

<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>



<tr>
    <td valign="top">
    <a href="../doc/RM/RM_H5F.html#File-GetFreespace">
    <code>H5Fget_freespace</code></a>
    </td>
    <td valign="top">
    &nbsp;
    </td>
    <td valign="top">
    Returns the amount of free space in a file.
    </td>
</tr>

<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>



<tr>
    <td>
    <a href="../doc/RM/RM_H5F.html#File-GetInfo2">
    <code>H5Fget_info2</code></a> 
    </td>
    <td valign="top">
    &nbsp;
    </td>
    <td>
    Returns global information for a file.
    </td>
</tr>

<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>

<tr>
    <td>
    <a href="../doc/RM/RM_H5P.html#Property-GetFileSpaceStrategy">
    <code>H5Pget_file_space_strategy</code></a></td>
    <td valign="top">
    &nbsp;
    </td>
    <td>
    Retrieves the File Space Strategy for a file creation property list.</td>
    </td>
</tr>

<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>


<tr>
    <td>
    <a href="../doc/RM/RM_H5P.html#Property-SetFileSpaceStrategy">
    <code>H5Pset_file_space_strategy</code></a></td>
    <td valign="top">
    &nbsp;
    </td>
    <td>
    Sets the File Space Strategy for a file creation property list.</td>
    </td>
</tr>

<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>


<tr>
    <td>
    <a href="../doc/RM/RM_H5P.html#Property-GetFileSpacePageSize">
    <code>H5Pget_file_space_page_size</code></a>
    </td>
     <td valign="top">
    &nbsp;
    </td>
    <td>
    Retrieves the file space page size for paged aggregation.  
    </td>
</tr>
<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>

<tr>
    <td>
    <a href="../doc/RM/RM_H5P.html#Property-SetFileSpacePageSize">
    <code>H5Pset_file_space_page_size</code></a>
    </td>
     <td valign="top">
    &nbsp;
    </td>
    <td>
    Sets the file space page size for paged aggregation.  
    </td>
</tr>
<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>




</table></td></tr>
<!-- end nested table -->








<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>



<tr>
<td bgcolor="#FFFFFF" align="left" valign="top" colspan="2">
    <font size="5" color="#004488"><a name="Tools">Tools</a></font>
    </td></tr>



<tr>
    <td align="left" valign="top" colspan="2">
    The tools listed below have been modified to preserve or modify
    file freepace information appropriately when processing files 
    employing this feature.
    </td></tr>



<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>

<tr>
    <td colspan="2">
    <table border="0" width="100%" cellpadding="5">
    <tr> 
    <td align="left" valign="top" width="15%">
    <code>h5dump</code>
    </td>
    <td align="left" valign="top" width="85%">
    When printing the file creation property information for the superblock via the
    -B option, <code>h5dump</code> includes the block size obtained via <code>H5Pget_file_space_page_size</code>.
    </td>
    </tr>
    </table>
    </td>
</tr>


<tr>
    <td colspan="2">
    <table border="0" width="100%" cellpadding="5">
    <tr> 
    <td align="left" valign="top" width="15%">
    <code>h5stat</code> 
    </td>
    <td align="left" valign="top" width="85%">
     When printing the file space information via the <code>-S</code> option, <code>h5stat</code>
     includes the block size obtained via <code>H5Pget_file_space_page_size</code>. 
    </td>
    </tr>
    </table>
    </td>
</tr>



<tr>
    <td colspan="2">
    <table border="0" width="100%" cellpadding="5">
    <tr>
    <td align="left" valign="top" width="15%">
    <code><a href="../doc/RM/Tools.html#Tools-Repack">h5repack</a></code>
    </td>
    <td align="left" valign="top" width="85%">
    The following options were added to <code>h5repack</code>:
    <p/>
    <code>-G FS_PAGESIZE</code>,<code>--fs_pagesize=FS_PAGESIZE</code> enables the file
    space page size to be changed to <code>FS_PAGESIZE</code>.
    <p/>
    <code>-P FS_PERSIST</code>,<code>--fs_persist=FS_PERSIST</code> sets the persisting free space to persist
    (<code>1</code>) or to not persist (<code>0</code>).
    <p/>
    <code>-S FS_STRATEGY</code>, <code>--fs_strategy=FS_STRATEGY</code> sets the file space management strategy.
    <p/>
    <code>-T FS_THRESHOLD</code>, <code>--fs_threshold=FS_THRESHOLD</code> sets the free-space section threshold.
    </td>
    </tr>
    </table>
    </td>
</tr>


<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>



<!--
<tr>
    <td bgcolor="#FFFFFF" valign="top" colspan="2">
    <br />
    <font size="5" color="#004488"><a name="FileSpaceDesignDocuments">
    File Free Space Design Documents</a></font>
    </td></tr>



<tr>
    <td align="left" valign="top" colspan="2">
    The file free space design documents, listed below, describe how the feature 
    works and why design choices were made.
    </td></tr>



<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>




<tr>
<table border="0" width="100%" cellpadding="5">

<tr>
    <td width="40%" valign="top" align="left">
    <a href="SWMR/Design-Metadata-Cache-Issues-Retries-SWMR-v3.pdf">
    Metadata Cache Issues under SWMR and their Solutions</a>
    </td>
    <td width="60%" valign="top" align="left">
    The HDF5 Library contains a cache that provides more efficient 
    access to HDF5 file metadata. Although helpful in most instances, 
    this cache can cause problems when the 
    single-writer/multiple-reader (SWMR) data access pattern is 
    used to access an HDF5 file. Additionally, there are even 
    deeper I/O issues that can affect HDF5 file metadata operations. 
    This document describes the cache-oriented problems that the 
    HDF5 Library must overcome in order to implement the SWMR 
    feature as well as our solutions.
    </td>
</tr>

<tr><td bgcolor="#FFFFFF" valign="top" colspan="2">&nbsp;</td></tr>
-->



<tr><td bgcolor="#FFFFFF" colspan="2">&nbsp;</td></tr>



</table></td></tr>



</table>
<br />



<!-- BEGIN FOOTER INFO -->

<br />
<hr />
<table border="0" width="100%">
    <tr><td width="45%" align="left" valign="bottom">
        <font face="arial,helvetica" size="-1">
        The HDF Group Help Desk: <img src="Graphics/help.png" align="middle" 
        height="14" alt="The HDF Group Help Desk"></font>
<!--
        <br />
        Describes HDF5 Release 1.9.x (development snapshots)
-->
        <br />
        <!-- hhmts start -->
        <font face="arial,helvetica" size="-1">
        Last modified: February 2017 
        <!-- hhmts end -->

        <p>
        </font>
    </td><td width="10%" rowspan="2">&nbsp;
    </td><td width="45%" align="right" valign="top" rowspan="2">
        <font face="arial,helvetica" size="-1">
        <a href="https://support.hdfgroup.org/ftp/HDF5/releases/COPYING">Copyright</a> by The HDF Group and the Board 
        <br />
        of Trustees of the University of Illinois.  
        <br />
        All rights reserved.
        </font>
<!--
        <a href="http://www.hdfgroup.org/">
        <img border=0 src="Graphics/THGwTextSm.jpg" width=130 height="7"8 
            alt="The HDF Group [Logo]"></a>
        <a href="http://www.hdfgroup.org/">
        <img border=0 src="Graphics/THGwTextSm.jpg" width=110 height=65 
            alt="The HDF Group [Logo]"></a>
        <a href="http://www.hdfgroup.org/">
        <img border=0 src="Graphics/THGwTextSm.jpg" width=78 height=48 
            alt="The HDF Group [Logo]"></a>
        <a href="http://www.hdfgroup.org/">
        <img border=0 src="Graphics/THGnoTextSm.jpg" width=78 height=41 
            alt="The HDF Group [Logo]"></a>
-->
    </td></tr>
</table>






</body>
</html>
